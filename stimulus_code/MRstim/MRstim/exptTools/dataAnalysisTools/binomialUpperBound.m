function upper = binomialUpperBound(confidence,k,n)% function lower = binomialUpperBound(confidence,k,n)%% Returns the upper end of a two-sided confidence% interval on the underlying probability of a head on% a single trial.%% confidence is the confidence interval, k is the% number of heads, and n is the number of coin tosses.izero = find(k==0);in = find(k==n);imid = find(k~=0 & k~=n);upper = zeros(1,length(n));upper(izero) = 1-(1-confidence).^(1./n(izero));upper(in) = 1;right = k(imid)+0.5;s = inverseNormal(sqrt(confidence));ss = s^2;upper(imid) = (right+0.5*ss+s*sqrt(right.*(1-right./n(imid))+0.25*ss))./(n(imid)+ss);